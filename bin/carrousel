#!/usr/bin/env ruby

require 'carrousel'
require 'optparse'

@opts = {}
OptionParser.new do |op|
  op.banner = "Usage: #{__FILE__} [options] [command] [item1 item2 ...]"

  op.on('-v', '--[no-]verbose', 'Run verbosely') do |v|
    @opts[:verbose] = v
  end

  op.on('-c', '--command COMMAND', 'Command to execute') do |c|
    @opts[:command] = c
  end

  op.on('-l', '--listfile FILE', 'File containing list of items') do |l|
    @opts[:listfile] = File.expand_path(l)
  end

  op.on('--[no-]debug', 'Enable debug output') do |d|
    @opts[:debug] = d
    @opts[:verbose] ||= d
  end

  op.on('-s' '--statusfile FILE', 'File with previously saved status') do |s|
    @opts[:statusfile] = File.expand_path(s)
  end
end.parse!

@opts = {
  :verbose => false,
  :command => nil,
  :listfile => nil,
  :statusfile => nil,
  :debug => false
}.merge(@opts)

Carrousel::Runner.new(ARGV, @opts).run
